

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06_04_Deep_Learning';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapitre 7 - Passage au big data (1ère partie)" href="07_01_Big_data_import.html" />
    <link rel="prev" title="Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)" href="06_03_NLP.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bienvenue sur le site de TRA BI NENE OTHNIEL
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">mes recherches et tout ce qui est utiles</a></li>

<li class="toctree-l1"><a class="reference internal" href="02_python_from_scratch.html">Chapitre 2 - Les bases de Python / Python from scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_numpy_pandas_bases.html">Chapitre 3 - Python et les données (NumPy et Pandas)</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_01_recuperation_des_donnees.html">Chapitre 4 - La préparation des données et les premières statistiques (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_02_manipulation_description_des_donnees.html">Chapitre 4 - La préparation des données et les premières statistiques (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_01_Data_visualisation_matplotlib_seaborn.html">Chapitre 5 - La data visualisation avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_02_Data_visualisation_cartographie.html">Chapitre 5 - La data visualisation avec Python (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_03_Visualisations_interactives.html">Chapitre 5 - La data visualisation avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_01_Machine_learning_supervise.html">Chapitre 6 - Différentes utilisations dumachine learning avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Random%20Forest.html">librairies de base</a></li>






<li class="toctree-l1"><a class="reference internal" href="06_02_Machine_learning_non_supervise.html">Chapitre 6 - Différentes utilisations du machine learning avec Python (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_03_NLP.html">Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_01_Big_data_import.html">Chapitre 7 - Passage au big data (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_02_Spark.html">Chapitre 7 - Passage au big data (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAA_test-checkpoint.html">1. Modelisation des rendements</a></li>

<li class="toctree-l1"><a class="reference internal" href="FORMATION%20PYTHON-checkpoint.html">Introduction</a></li>






<li class="toctree-l1"><a class="reference internal" href="Introduction%20%C3%A0%20Scikit%20Learn-checkpoint.html">Introduction à Scikit Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python%20vs%20R-checkpoint.html">Python vs R : le duel</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F06_04_Deep_Learning.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/06_04_Deep_Learning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#le-deep-learning-avec-keras">6.7 Le deep learning avec Keras</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principe-dun-reseau-de-neurone-et-premiere-utilisation-avec-keras">6.7.2 Principe d’un réseau de neurone et première utilisation avec Keras</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#le-deep-learning-et-les-reseaux-de-neurones-a-convolutions">6.7.3 Le deep learning et les réseaux de neurones à convolutions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aller-plus-loin-generation-de-features-transfer-learning-rn-gan">6.7.4 Aller plus loin : génération de features, transfer learning, RN, GAN …</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapitre-6-differentes-utilisations-dumachine-learning-avec-python-4eme-partie">
<h1>Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)<a class="headerlink" href="#chapitre-6-differentes-utilisations-dumachine-learning-avec-python-4eme-partie" title="Permalink to this heading">#</a></h1>
<section id="le-deep-learning-avec-keras">
<h2>6.7 Le deep learning avec Keras<a class="headerlink" href="#le-deep-learning-avec-keras" title="Permalink to this heading">#</a></h2>
<section id="principe-dun-reseau-de-neurone-et-premiere-utilisation-avec-keras">
<h3>6.7.2 Principe d’un réseau de neurone et première utilisation avec Keras<a class="headerlink" href="#principe-dun-reseau-de-neurone-et-premiere-utilisation-avec-keras" title="Permalink to this heading">#</a></h3>
<p>Le package Keras que nous avons installé est basé sur une structure extrêmement
simple à mettre en oeuvre. On commence par définir le type de réseau utilisé. Dans
cet ouvrage, il s’agira de réseaux séquentiels.</p>
<p>Si nous prenons les données sur les télécommunications que nous avons utilisées
précédemment, nous pouvons simplement utiliser Keras pour créer un réseau de neurones assez évolué (on suppose ici que les données ont été préparées comme
dans la première partie de ce chapitre avec Scikit-Learn) :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">BatchNormalization</span><span class="p">,</span> <span class="n">Activation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">BatchNormalization</span><span class="p">,</span> <span class="n">Activation</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tensorflow&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/x_telecom.csv&quot;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/y_telecom.csv&quot;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="c1"># on sépare nos données en apprentissage/validation avec Scikit-Learn</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on crée le modèle</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on ajoute des couches avec des fonctions d’activation</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="c1"># cette couche permet de normaliser les données</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
<span class="c1"># cette couche va faire en sorte d’éviter l’overfitting</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># on ajoute un autre groupe de couches</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># on ajoute la couche de sortie</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on définit la fonction de perte et la fonction d’optiimsation</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on ajuste le modèle</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/100
27/27 [==============================] - 0s 2ms/step - loss: 0.8044 - accuracy: 0.5949
Epoch 2/100
27/27 [==============================] - 0s 2ms/step - loss: 0.6631 - accuracy: 0.6718
Epoch 3/100
27/27 [==============================] - 0s 2ms/step - loss: 0.5822 - accuracy: 0.7198
Epoch 4/100
27/27 [==============================] - ETA: 0s - loss: 0.5760 - accuracy: 0.69 - 0s 2ms/step - loss: 0.5351 - accuracy: 0.7663
Epoch 5/100
27/27 [==============================] - 0s 2ms/step - loss: 0.4934 - accuracy: 0.7926
Epoch 6/100
27/27 [==============================] - 0s 2ms/step - loss: 0.4471 - accuracy: 0.8342
Epoch 7/100
27/27 [==============================] - 0s 2ms/step - loss: 0.4148 - accuracy: 0.8530
Epoch 8/100
27/27 [==============================] - 0s 2ms/step - loss: 0.3876 - accuracy: 0.8616
Epoch 9/100
27/27 [==============================] - 0s 2ms/step - loss: 0.3498 - accuracy: 0.8845
Epoch 10/100
27/27 [==============================] - 0s 2ms/step - loss: 0.3285 - accuracy: 0.8946
Epoch 11/100
27/27 [==============================] - 0s 2ms/step - loss: 0.3133 - accuracy: 0.9010
Epoch 12/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2913 - accuracy: 0.9032
Epoch 13/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2844 - accuracy: 0.9066
Epoch 14/100
27/27 [==============================] - 0s 3ms/step - loss: 0.2723 - accuracy: 0.9111
Epoch 15/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2448 - accuracy: 0.9235
Epoch 16/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2395 - accuracy: 0.9239
Epoch 17/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2382 - accuracy: 0.9164
Epoch 18/100
27/27 [==============================] - 0s 1ms/step - loss: 0.2227 - accuracy: 0.9242
Epoch 19/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2293 - accuracy: 0.9231
Epoch 20/100
27/27 [==============================] - 0s 1ms/step - loss: 0.2175 - accuracy: 0.9242
Epoch 21/100
27/27 [==============================] - 0s 1ms/step - loss: 0.2011 - accuracy: 0.9381
Epoch 22/100
27/27 [==============================] - 0s 1ms/step - loss: 0.2071 - accuracy: 0.9287
Epoch 23/100
27/27 [==============================] - 0s 2ms/step - loss: 0.2079 - accuracy: 0.9272
Epoch 24/100
27/27 [==============================] - 0s 1ms/step - loss: 0.2041 - accuracy: 0.9310
Epoch 25/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1937 - accuracy: 0.9310
Epoch 26/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1991 - accuracy: 0.9310
Epoch 27/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1926 - accuracy: 0.9344
Epoch 28/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1843 - accuracy: 0.9389
Epoch 29/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1914 - accuracy: 0.9362
Epoch 30/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1913 - accuracy: 0.9332
Epoch 31/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1793 - accuracy: 0.9392
Epoch 32/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1805 - accuracy: 0.9411
Epoch 33/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1811 - accuracy: 0.9359
Epoch 34/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1840 - accuracy: 0.9362
Epoch 35/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1774 - accuracy: 0.9389
Epoch 36/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1707 - accuracy: 0.9422
Epoch 37/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1738 - accuracy: 0.9389
Epoch 38/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1579 - accuracy: 0.9471
Epoch 39/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1602 - accuracy: 0.9479
Epoch 40/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1572 - accuracy: 0.9441
Epoch 41/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1569 - accuracy: 0.9456
Epoch 42/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1568 - accuracy: 0.9482
Epoch 43/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1698 - accuracy: 0.9437
Epoch 44/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1602 - accuracy: 0.9415
Epoch 45/100
27/27 [==============================] - 0s 3ms/step - loss: 0.1671 - accuracy: 0.9441
Epoch 46/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1563 - accuracy: 0.9460
Epoch 47/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1555 - accuracy: 0.9441
Epoch 48/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1557 - accuracy: 0.9467
Epoch 49/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1490 - accuracy: 0.9494
Epoch 50/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1397 - accuracy: 0.9546
Epoch 51/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1450 - accuracy: 0.9516
Epoch 52/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1499 - accuracy: 0.9512
Epoch 53/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1444 - accuracy: 0.9550
Epoch 54/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1436 - accuracy: 0.9542
Epoch 55/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1406 - accuracy: 0.9531
Epoch 56/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1479 - accuracy: 0.9527
Epoch 57/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1373 - accuracy: 0.9527
Epoch 58/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1396 - accuracy: 0.9539
Epoch 59/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1409 - accuracy: 0.9542
Epoch 60/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1419 - accuracy: 0.9535
Epoch 61/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1428 - accuracy: 0.9524
Epoch 62/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1438 - accuracy: 0.9501
Epoch 63/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1289 - accuracy: 0.9614
Epoch 64/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1405 - accuracy: 0.9539
Epoch 65/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1315 - accuracy: 0.9546
Epoch 66/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1318 - accuracy: 0.9595
Epoch 67/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1275 - accuracy: 0.9584
Epoch 68/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1332 - accuracy: 0.9595
Epoch 69/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1291 - accuracy: 0.9569
Epoch 70/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1265 - accuracy: 0.9610
Epoch 71/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1289 - accuracy: 0.9614
Epoch 72/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1336 - accuracy: 0.9565
Epoch 73/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1298 - accuracy: 0.9587
Epoch 74/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1304 - accuracy: 0.9584
Epoch 75/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1277 - accuracy: 0.9565
Epoch 76/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1229 - accuracy: 0.9602
Epoch 77/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1205 - accuracy: 0.9625
Epoch 78/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1226 - accuracy: 0.9569
Epoch 79/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1199 - accuracy: 0.9610
Epoch 80/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1223 - accuracy: 0.9554
Epoch 81/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1266 - accuracy: 0.9550
Epoch 82/100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27/27 [==============================] - 0s 2ms/step - loss: 0.1270 - accuracy: 0.9572
Epoch 83/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1179 - accuracy: 0.9580
Epoch 84/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1168 - accuracy: 0.9625
Epoch 85/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1219 - accuracy: 0.9587
Epoch 86/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1112 - accuracy: 0.9617
Epoch 87/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1259 - accuracy: 0.9580
Epoch 88/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1210 - accuracy: 0.9640
Epoch 89/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1275 - accuracy: 0.9599
Epoch 90/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1183 - accuracy: 0.9621
Epoch 91/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1200 - accuracy: 0.9602
Epoch 92/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1070 - accuracy: 0.9644
Epoch 93/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1277 - accuracy: 0.9584
Epoch 94/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1184 - accuracy: 0.9576
Epoch 95/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1218 - accuracy: 0.9587
Epoch 96/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1131 - accuracy: 0.9651
Epoch 97/100
27/27 [==============================] - 0s 2ms/step - loss: 0.1206 - accuracy: 0.9625
Epoch 98/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1219 - accuracy: 0.9580
Epoch 99/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1177 - accuracy: 0.9602
Epoch 100/100
27/27 [==============================] - 0s 1ms/step - loss: 0.1164 - accuracy: 0.9655
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tensorflow.python.keras.callbacks.History at 0x1fa39c65610&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:From &lt;ipython-input-8-8e04b3464b2b&gt;:1: Sequential.predict_proba (from tensorflow.python.keras.engine.sequential) is deprecated and will be removed after 2021-01-01.
Instructions for updating:
Please use `model.predict()` instead.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[9.97193336e-01],
       [3.62157822e-02],
       [9.85870242e-01],
       [1.70528471e-01],
       [3.50208282e-02],
       [7.84272850e-02],
       [7.66124427e-02],
       [1.00000000e+00],
       [2.41908431e-03],
       [1.49467885e-02],
       [2.03776360e-03],
       [8.20812583e-03],
       [1.00000000e+00],
       [5.10457158e-03],
       [4.07670468e-01],
       [3.23989987e-03],
       [7.64716864e-02],
       [6.17393315e-01],
       [2.71230936e-04],
       [3.12215984e-02],
       [2.53165126e-01],
       [9.21270132e-01],
       [4.37194109e-03],
       [9.41532850e-03],
       [1.15052462e-02],
       [9.84957337e-01],
       [3.87486815e-03],
       [1.29806399e-02],
       [1.67300701e-02],
       [1.74522400e-04],
       [1.07380748e-03],
       [2.69854069e-03],
       [1.71230733e-01],
       [6.13301992e-04],
       [6.64949417e-03],
       [2.68164575e-02],
       [1.21217966e-02],
       [9.99880195e-01],
       [3.58045101e-03],
       [1.15264654e-02],
       [2.46448517e-02],
       [4.55545783e-02],
       [6.48289919e-04],
       [2.30314434e-02],
       [6.02111220e-03],
       [4.64465618e-02],
       [1.75162554e-02],
       [3.75658274e-04],
       [3.98486853e-03],
       [2.00235248e-02],
       [7.42852688e-04],
       [1.63729370e-01],
       [1.90771520e-02],
       [8.21766257e-03],
       [1.53389573e-03],
       [2.16841698e-04],
       [1.73256874e-01],
       [1.57057941e-02],
       [1.16938651e-02],
       [5.57951331e-02],
       [2.41702795e-03],
       [2.90569663e-03],
       [1.40139461e-03],
       [3.79735529e-02],
       [1.11677825e-01],
       [7.93740153e-03],
       [3.81286025e-01],
       [1.34772360e-02],
       [1.91813141e-01],
       [2.26494968e-02],
       [3.05483043e-02],
       [1.08544528e-02],
       [7.03412294e-03],
       [7.89627075e-01],
       [9.97381926e-01],
       [8.86350274e-02],
       [1.77180767e-03],
       [8.54390860e-03],
       [8.52040946e-02],
       [1.19647384e-03],
       [1.23126805e-01],
       [1.07279420e-03],
       [1.00000000e+00],
       [1.01259649e-02],
       [4.99904156e-04],
       [4.63491678e-03],
       [1.34962797e-02],
       [4.38421667e-02],
       [5.19216061e-04],
       [1.41364336e-03],
       [5.39821386e-03],
       [4.01200145e-01],
       [4.26441431e-04],
       [5.07642627e-02],
       [4.97083664e-02],
       [7.61307120e-01],
       [1.03096724e-01],
       [6.72250986e-03],
       [7.83899426e-03],
       [2.95281410e-04],
       [7.33214617e-03],
       [9.99989092e-01],
       [1.13173664e-01],
       [1.15000308e-02],
       [5.80871105e-03],
       [1.92778170e-01],
       [4.13209200e-04],
       [2.71221399e-02],
       [1.00000000e+00],
       [4.50356305e-02],
       [7.11619854e-04],
       [2.08978057e-02],
       [9.34267044e-03],
       [1.82884336e-02],
       [1.70016289e-02],
       [4.99691367e-02],
       [1.72073364e-01],
       [9.98978853e-01],
       [6.15998805e-02],
       [5.71447611e-03],
       [9.98089850e-01],
       [1.17774904e-02],
       [1.35764569e-01],
       [4.11477685e-03],
       [2.77453661e-03],
       [2.21648216e-02],
       [3.50427628e-03],
       [3.85989249e-02],
       [1.53947473e-02],
       [4.24442858e-01],
       [3.95786762e-02],
       [3.83769274e-02],
       [2.56992877e-02],
       [3.39961112e-01],
       [1.00000000e+00],
       [9.81180787e-01],
       [5.10540605e-03],
       [3.27780843e-03],
       [1.67777300e-01],
       [1.42736584e-01],
       [4.05684114e-03],
       [4.76612449e-02],
       [3.67969275e-04],
       [3.70962918e-02],
       [1.79913640e-02],
       [9.98266697e-01],
       [2.15574503e-02],
       [1.06289983e-03],
       [9.36499238e-02],
       [1.99633837e-03],
       [8.72468948e-03],
       [1.00000000e+00],
       [3.19288671e-02],
       [3.16494703e-02],
       [5.15848398e-03],
       [9.93878126e-01],
       [9.24959779e-03],
       [9.55851078e-02],
       [1.56565309e-02],
       [2.35170126e-04],
       [7.25353539e-01],
       [2.23171413e-02],
       [1.15553141e-02],
       [4.83043492e-02],
       [6.32396340e-02],
       [3.20622325e-03],
       [1.03065670e-02],
       [2.39610672e-03],
       [9.39364731e-02],
       [5.95539808e-04],
       [2.91782618e-03],
       [1.31249428e-04],
       [1.16282105e-02],
       [6.34545982e-02],
       [8.04504752e-03],
       [1.38378143e-03],
       [2.61598825e-03],
       [1.35492980e-02],
       [8.48434865e-02],
       [9.86635685e-03],
       [6.56834245e-02],
       [1.89075768e-02],
       [5.35368919e-03],
       [8.84957552e-01],
       [8.60638380e-01],
       [7.68178701e-03],
       [5.36909699e-02],
       [4.51519191e-02],
       [2.96832919e-02],
       [8.04334879e-04],
       [1.14286244e-02],
       [8.95481586e-01],
       [2.38135457e-03],
       [7.28283048e-01],
       [3.06772590e-02],
       [1.93508565e-02],
       [1.20809674e-02],
       [3.79294157e-04],
       [7.68024325e-02],
       [9.98932421e-01],
       [2.37050056e-02],
       [1.87575817e-02],
       [2.43562460e-03],
       [8.85513902e-01],
       [6.77603483e-03],
       [3.07345986e-02],
       [2.03713775e-03],
       [9.99974370e-01],
       [5.00579178e-02],
       [3.48715782e-02],
       [7.90268183e-04],
       [9.99878407e-01],
       [1.87570453e-02],
       [9.11274552e-03],
       [1.31871998e-02],
       [9.97478068e-01],
       [6.18070960e-02],
       [1.37480795e-02],
       [5.91448247e-02],
       [1.00086331e-02],
       [1.77494884e-02],
       [7.26210773e-02],
       [5.98037243e-03],
       [8.72379541e-03],
       [7.61938095e-03],
       [9.15832222e-02],
       [1.72922015e-02],
       [1.89419985e-02],
       [1.97223723e-02],
       [6.61072135e-03],
       [7.74756074e-03],
       [2.68208981e-03],
       [8.89743805e-01],
       [2.64216959e-02],
       [8.04018974e-03],
       [7.84272850e-02],
       [1.73951983e-02],
       [1.56462193e-03],
       [4.69796658e-02],
       [2.47269869e-04],
       [9.91690636e-01],
       [2.88382173e-03],
       [1.50190592e-02],
       [2.76115537e-03],
       [9.99891579e-01],
       [7.75417686e-03],
       [3.19336057e-02],
       [9.99643087e-01],
       [5.88850081e-02],
       [9.95499015e-01],
       [1.94531679e-03],
       [8.81189942e-01],
       [9.98798847e-01],
       [9.62406397e-04],
       [1.94689631e-03],
       [3.20301652e-02],
       [7.38579035e-03],
       [2.16883421e-03],
       [9.99999523e-01],
       [8.92138481e-03],
       [9.85964179e-01],
       [1.34190619e-02],
       [3.75375152e-03],
       [9.04470682e-04],
       [2.25108325e-01],
       [2.63324678e-02],
       [8.21799040e-04],
       [9.99835491e-01],
       [3.83526087e-04],
       [1.33830637e-01],
       [3.05724442e-02],
       [9.79121864e-01],
       [1.57015026e-02],
       [9.98743534e-01],
       [1.43574178e-02],
       [9.47950840e-01],
       [1.51088834e-03],
       [2.01341808e-02],
       [3.37013602e-03],
       [9.90290642e-01],
       [9.89536881e-01],
       [2.12432325e-01],
       [5.18104970e-01],
       [8.87140632e-03],
       [3.42515111e-03],
       [3.88902426e-03],
       [1.75721347e-02],
       [1.77069008e-02],
       [2.46375799e-04],
       [1.66545510e-02],
       [1.61407292e-02],
       [2.20994949e-02],
       [4.27097082e-03],
       [3.38295698e-02],
       [7.66664743e-04],
       [9.29388404e-03],
       [4.38117981e-03],
       [5.12987375e-03],
       [8.58041644e-03],
       [3.58205110e-01],
       [2.82788277e-03],
       [3.09106708e-03],
       [3.86679173e-03],
       [5.45498729e-02],
       [2.51297355e-02],
       [4.56371903e-03],
       [8.66715418e-05],
       [4.77098614e-01],
       [3.86404097e-02],
       [5.46928287e-01],
       [4.46218252e-03],
       [6.86734915e-03],
       [2.27179527e-02],
       [1.09615028e-02],
       [1.51932240e-03],
       [8.98970544e-01],
       [1.24791265e-03],
       [9.13888216e-04],
       [1.15760863e-02],
       [6.74453378e-03],
       [9.44395065e-01],
       [1.29411519e-02],
       [9.92742181e-01],
       [9.97862339e-01],
       [6.19265437e-03],
       [1.63094401e-02],
       [7.77333081e-01],
       [3.50256562e-02],
       [1.00000000e+00],
       [4.12613451e-02],
       [3.27473879e-03],
       [4.69155312e-02],
       [3.85257602e-03],
       [7.36896992e-02],
       [3.03274989e-02],
       [2.33642131e-01],
       [3.67873907e-03],
       [2.13235557e-01],
       [2.85655260e-04],
       [2.21734047e-02],
       [3.83973122e-04],
       [2.42862105e-03],
       [1.23635232e-02],
       [5.94356596e-01],
       [9.73174274e-02],
       [9.19801295e-02],
       [1.48791075e-03],
       [4.63366508e-03],
       [4.66614962e-04],
       [7.30282068e-03],
       [7.32783973e-02],
       [4.66614962e-04],
       [1.16664171e-02],
       [6.73108399e-02],
       [2.81750262e-02],
       [4.91499901e-04],
       [8.94135833e-02],
       [1.68573558e-02],
       [9.99985695e-01],
       [5.96785545e-03],
       [3.75440717e-02],
       [1.60475433e-01],
       [1.58969462e-02],
       [1.72761381e-02],
       [6.20241463e-02],
       [8.65875781e-02],
       [3.63403559e-03],
       [1.33832991e-02],
       [4.72037196e-02],
       [4.56783175e-03],
       [7.25452483e-01],
       [4.09935564e-01],
       [7.20104575e-03],
       [6.12477541e-01],
       [5.92182577e-02],
       [4.58620250e-01],
       [7.70218372e-02],
       [8.33199024e-02],
       [3.14105421e-01],
       [7.10815191e-04],
       [1.57566190e-01],
       [5.74467778e-02],
       [9.97284055e-03],
       [2.39769220e-02],
       [1.74318850e-02],
       [4.83912826e-01],
       [2.32294917e-01],
       [1.52210295e-02],
       [1.92483664e-02],
       [1.50065720e-02],
       [6.84258342e-03],
       [7.74103284e-01],
       [1.56977773e-03],
       [9.98242855e-01],
       [1.02467537e-02],
       [9.98652756e-01],
       [1.99094415e-03],
       [3.04883718e-03],
       [5.01029491e-02],
       [1.20204389e-02],
       [5.79416752e-04],
       [3.59299481e-02],
       [9.95486975e-04],
       [6.80583715e-03],
       [5.51593304e-03],
       [8.59380722e-01],
       [2.17055976e-02],
       [9.99997318e-01],
       [7.91698694e-04],
       [1.05057985e-01],
       [1.20867789e-02],
       [9.99940217e-01],
       [1.98966265e-03],
       [3.85239720e-03],
       [1.00000000e+00],
       [1.15470260e-01],
       [2.37761140e-02],
       [4.39326495e-01],
       [9.99989629e-01],
       [3.30012441e-02],
       [3.14964950e-02],
       [2.12541223e-03],
       [2.01522112e-02],
       [1.21759818e-04],
       [9.95342970e-01],
       [1.56661272e-02],
       [4.81778383e-03],
       [2.29001045e-04],
       [7.29951262e-03],
       [1.16775334e-02],
       [1.38849020e-03],
       [2.20448971e-02],
       [1.69909000e-03],
       [3.39501500e-02],
       [6.00602388e-01],
       [9.99429226e-01],
       [2.72098184e-03],
       [6.32733107e-04],
       [7.79688358e-04],
       [3.17699969e-01],
       [1.36068463e-03],
       [7.66107142e-02],
       [3.70772183e-02],
       [6.95216656e-03],
       [6.72105551e-01],
       [2.69606709e-03],
       [5.59522510e-02],
       [4.91505563e-02],
       [1.63173378e-02],
       [2.06704954e-05],
       [7.16412067e-03],
       [9.37891006e-03],
       [8.15619230e-02],
       [1.32033229e-02],
       [4.16883081e-01],
       [6.32080436e-03],
       [5.33074141e-03],
       [1.42768025e-03],
       [4.81978953e-02],
       [3.35836411e-03],
       [3.78471613e-02],
       [2.57827938e-02],
       [1.54948235e-03],
       [2.44693458e-02],
       [7.63270557e-02],
       [8.74722004e-03],
       [3.15573812e-03],
       [9.66638327e-03],
       [6.27666712e-04],
       [1.45915151e-03],
       [7.80514777e-02],
       [1.71652734e-02],
       [2.85835862e-02],
       [2.47386694e-02],
       [5.73205948e-03],
       [4.71915305e-02],
       [2.45761573e-02],
       [7.53730536e-04],
       [9.99986887e-01],
       [1.49181485e-03],
       [3.60292196e-03],
       [2.95193195e-02],
       [9.93392527e-01],
       [1.60705447e-02],
       [9.40859318e-03],
       [2.02414393e-03],
       [4.07271087e-02],
       [5.90197623e-01],
       [1.51062012e-03],
       [6.87535286e-01],
       [7.08138943e-02],
       [1.76481903e-02],
       [9.71811235e-01],
       [2.55701244e-02],
       [7.48106837e-03],
       [1.01791322e-02],
       [1.95619166e-02],
       [9.61793959e-02],
       [5.68065047e-03],
       [9.61260319e-01],
       [9.99630749e-01],
       [1.79435015e-02],
       [2.65699625e-03],
       [4.87046540e-02],
       [2.58875906e-01],
       [9.99661803e-01],
       [3.52504849e-03],
       [3.14711630e-02],
       [5.35786152e-04],
       [3.94338965e-02],
       [1.31818652e-03],
       [5.24067879e-03],
       [9.55114424e-01],
       [4.92878288e-01],
       [5.04390001e-02],
       [1.18604302e-02],
       [1.02701902e-01],
       [9.95507479e-01],
       [2.86066234e-02],
       [1.10334456e-02],
       [1.45187676e-02],
       [2.48785913e-02],
       [3.41721475e-02],
       [7.54337609e-02],
       [3.04316580e-02],
       [5.29679656e-03],
       [2.46554613e-04],
       [2.14998722e-02],
       [1.18424445e-01],
       [7.04467297e-04],
       [6.06192298e-05],
       [1.59471631e-02],
       [6.30468130e-04],
       [2.95303464e-02],
       [3.54397297e-03],
       [5.88595867e-04],
       [1.10315979e-01],
       [6.86404109e-03],
       [3.51428986e-04],
       [1.25220418e-02],
       [1.89122558e-03],
       [3.26469839e-02],
       [7.87965655e-02],
       [1.00000000e+00],
       [8.56288314e-01],
       [9.90858674e-03],
       [3.94326448e-02],
       [4.11707163e-03],
       [1.29841268e-02],
       [1.94950104e-02],
       [7.51301348e-02],
       [2.61509418e-03],
       [9.00155306e-03],
       [8.83084536e-03],
       [3.38071883e-02],
       [6.94379210e-03],
       [1.60026550e-03],
       [9.82704878e-01],
       [2.45280564e-02],
       [5.20229936e-02],
       [9.99998212e-01],
       [1.67010725e-02],
       [4.79366779e-02],
       [6.93127513e-02],
       [5.32895327e-04],
       [1.03970170e-02],
       [2.32737958e-02],
       [1.44482225e-01],
       [2.03428268e-02],
       [9.26703215e-03],
       [4.21118438e-01],
       [1.08495355e-03],
       [1.02427810e-01],
       [8.61136854e-01],
       [2.45471001e-02],
       [2.74194747e-01],
       [9.99887526e-01],
       [6.61671162e-04],
       [4.54304814e-02],
       [2.68332362e-02],
       [4.71216440e-03],
       [4.73498106e-02],
       [7.98596382e-01],
       [2.78118849e-02],
       [3.66120636e-01],
       [1.28363371e-02],
       [3.87072563e-04],
       [2.05316722e-01],
       [2.30389833e-03],
       [2.48211622e-03],
       [1.10919178e-02],
       [3.87190223e-01],
       [1.57179236e-02],
       [7.88778067e-04],
       [2.13919878e-02],
       [2.94046700e-02],
       [9.99982238e-01],
       [5.75095415e-04],
       [1.36597633e-01],
       [3.81901860e-03],
       [5.24252653e-03],
       [2.11212933e-02],
       [8.00174475e-03],
       [1.31913424e-01],
       [4.38451767e-04],
       [1.64330006e-03],
       [6.05225563e-03],
       [7.89916515e-03],
       [1.00000000e+00],
       [3.07870805e-02],
       [2.17795372e-04],
       [1.79305673e-03],
       [1.76807940e-02],
       [2.74091959e-04],
       [1.68487430e-03],
       [9.08926129e-03],
       [2.23915279e-02],
       [3.01392496e-01],
       [2.18646526e-02],
       [5.05015254e-03],
       [1.30890906e-02],
       [8.22186470e-04],
       [3.39295566e-02],
       [7.28845596e-04],
       [1.71135366e-02],
       [1.20565295e-03],
       [7.62179494e-03],
       [1.14914775e-03],
       [5.04197776e-02],
       [9.99998748e-01],
       [3.20219398e-02],
       [3.62567902e-02],
       [3.42190266e-04],
       [1.29044056e-03],
       [3.58772278e-02],
       [4.47821617e-03],
       [4.65765595e-03],
       [1.34199262e-02],
       [1.02871656e-02],
       [4.38898802e-03],
       [2.63959169e-04],
       [1.75965130e-02],
       [4.21762466e-03],
       [4.82288003e-03],
       [7.73400068e-04],
       [1.03965402e-03],
       [1.38759613e-03],
       [3.18702161e-02],
       [1.09404325e-02],
       [1.48087740e-03],
       [1.00000000e+00],
       [4.08297777e-03],
       [2.92280614e-02],
       [1.34512484e-02],
       [3.36226225e-02],
       [4.91210818e-03],
       [1.07103586e-03],
       [3.65700722e-02],
       [4.27633524e-04],
       [8.63179564e-03],
       [1.40458345e-03],
       [2.25573778e-04],
       [9.85270739e-03],
       [9.30499494e-01],
       [1.36006176e-02],
       [2.14432389e-01],
       [1.80578232e-02]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on calcule l’AUC pour les données de validation</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC pour RN :&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span>
                                     <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AUC pour RN : 0.9186596668611055
</pre></div>
</div>
</div>
</div>
<p>Les réseaux de neurones sont des méthodes extrêmement efficaces à condition
de bien les paramétrer ce qui peut s‘avérer très difficile.</p>
</section>
<section id="le-deep-learning-et-les-reseaux-de-neurones-a-convolutions">
<h3>6.7.3 Le deep learning et les réseaux de neurones à convolutions<a class="headerlink" href="#le-deep-learning-et-les-reseaux-de-neurones-a-convolutions" title="Permalink to this heading">#</a></h3>
<p>On va maintenant travailler sur des images. On prendra les données fashion-mnist :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPool2D</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">fashion_mnist</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># récupération des données</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># les données sont transformées pour passer sous un format d’image</span>
<span class="c1"># standard avec des valeurs entre 0 et 1</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_train</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_test</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># passage à 10 colonnes pour y(une par modalité)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construction du modèle</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compilation du modèle</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ajustement du modèle</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
600/600 [==============================] - 43s 72ms/step - loss: 0.5484 - accuracy: 0.8068
Epoch 2/10
600/600 [==============================] - 44s 73ms/step - loss: 0.3659 - accuracy: 0.8703
Epoch 3/10
600/600 [==============================] - 43s 71ms/step - loss: 0.3183 - accuracy: 0.8852
Epoch 4/10
600/600 [==============================] - 46s 76ms/step - loss: 0.2926 - accuracy: 0.8932
Epoch 5/10
600/600 [==============================] - 46s 77ms/step - loss: 0.2670 - accuracy: 0.9036
Epoch 6/10
600/600 [==============================] - 51s 85ms/step - loss: 0.2470 - accuracy: 0.9101
Epoch 7/10
600/600 [==============================] - 48s 81ms/step - loss: 0.2328 - accuracy: 0.9141
Epoch 8/10
600/600 [==============================] - 50s 84ms/step - loss: 0.2179 - accuracy: 0.9205
Epoch 9/10
600/600 [==============================] - 51s 85ms/step - loss: 0.2085 - accuracy: 0.9229
Epoch 10/10
600/600 [==============================] - 49s 81ms/step - loss: 0.1969 - accuracy: 0.9277
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tensorflow.python.keras.callbacks.History at 0x1fa3e77be80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluation du modèle</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous avons appliqué deux couches de convolutions à 32 neurones avec une taille
de fenêtre de 3 par 3. Puis une couche de pooling avec une réduction sur des fenêtres
de 2 par 2. Nous obtenons les résultats suivants :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtention de l’accuracy sur les données de validation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pourcentage de bien classées :&quot;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pourcentage de bien classées : 0.9215999841690063
</pre></div>
</div>
</div>
</div>
<p>On voit qu’on est au-delà de 92 % bien classés sur l’échantillon de validation.
Dans notre cas, on a utilisé des images directement dans le package Keras.</p>
<p>Généralement, les images sont stockées dans des répertoires différents. Keras
possède de nombreux outils pour charger ces images, on peut par exemple utiliser
ImageDataGenerator :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.image</span> <span class="kn">import</span> <span class="n">ImageDataGenerator</span>

<span class="c1"># on définit un générateur qui pourrait modifier nos images</span>
<span class="c1"># (dans ce cas on passe en float 0 à 1)</span>
<span class="n">train_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
<span class="n">test_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>

<span class="c1"># on définit le dossier dans lequel se trouve les images</span>
<span class="n">train_generator</span> <span class="o">=</span> <span class="n">train_datagen</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span><span class="s1">&#39;../data/&#39;</span><span class="p">,</span><span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>
                                                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="c1"># on définit le dossier dans lequel se trouve les images</span>
<span class="n">validation_generator</span> <span class="o">=</span> <span class="n">test_datagen</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span><span class="s1">&#39;../data/&#39;</span><span class="p">,</span>
                                                        <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>
                                                        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                                        <span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 0 images belonging to 0 classes.
Found 0 images belonging to 0 classes.
</pre></div>
</div>
</div>
</div>
<p>Vous avez maintenant tous les outils pour vous lancer dans la construction de
réseaux de deep learning avec Python.</p>
</section>
<section id="aller-plus-loin-generation-de-features-transfer-learning-rn-gan">
<h3>6.7.4 Aller plus loin : génération de features, transfer learning, RN, GAN …<a class="headerlink" href="#aller-plus-loin-generation-de-features-transfer-learning-rn-gan" title="Permalink to this heading">#</a></h3>
<p>On charge facilement un modèle avec :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.applications.resnet50</span> <span class="kn">import</span> <span class="n">ResNet50</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.applications.resnet50</span> <span class="kn">import</span> <span class="n">preprocess_input</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.applications.resnet50</span> <span class="kn">import</span> <span class="n">decode_predictions</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on utilise le modèle ResNet50</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ResNet50</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;imagenet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on récupère une nouvelle image</span>
<span class="n">img_path</span> <span class="o">=</span> <span class="s1">&#39;../data/elephant.png&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">load_img</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">img_to_array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">preprocess_input</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on applique le modèle</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prédit (classe/ %):&#39;</span><span class="p">,</span> <span class="n">decode_predictions</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prédit (classe/ %): [(&#39;n02504458&#39;, &#39;African_elephant&#39;, 0.6474536)]
</pre></div>
</div>
</div>
</div>
<p>On obtient donc un résultat à partir du modèle chargé. On pourra utiliser ce modèle
et ses poids dans des couches intermédiaires de notre modèle.</p>
<p>Dans ce cas, on a chargé un modèle et on lui a fourni une photographie d’éléphant.
Le modèle considère que c’est un éléphant d’Afrique à 87%.</p>
<p>Nous avons effectué un panorama approfondi de l’utilisation de Python
pour faire du machine learning, du deep learning et du traitement des
données textuelles. Python ressort comme un langage adapté à toutes
ces approches et un outil indispensable pour le data scientist.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06_03_NLP.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)</p>
      </div>
    </a>
    <a class="right-next"
       href="07_01_Big_data_import.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapitre 7 - Passage au big data (1ère partie)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#le-deep-learning-avec-keras">6.7 Le deep learning avec Keras</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principe-dun-reseau-de-neurone-et-premiere-utilisation-avec-keras">6.7.2 Principe d’un réseau de neurone et première utilisation avec Keras</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#le-deep-learning-et-les-reseaux-de-neurones-a-convolutions">6.7.3 Le deep learning et les réseaux de neurones à convolutions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aller-plus-loin-generation-de-features-transfer-learning-rn-gan">6.7.4 Aller plus loin : génération de features, transfer learning, RN, GAN …</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>