

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06_03_NLP';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)" href="06_04_Deep_Learning.html" />
    <link rel="prev" title="Chapitre 6 - Différentes utilisations du machine learning avec Python (2ème partie)" href="06_02_Machine_learning_non_supervise.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bienvenue sur le site de TRA BI NENE OTHNIEL
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">mes recherches et tout ce qui est utiles</a></li>

<li class="toctree-l1"><a class="reference internal" href="02_python_from_scratch.html">Chapitre 2 - Les bases de Python / Python from scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_numpy_pandas_bases.html">Chapitre 3 - Python et les données (NumPy et Pandas)</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_01_recuperation_des_donnees.html">Chapitre 4 - La préparation des données et les premières statistiques (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_02_manipulation_description_des_donnees.html">Chapitre 4 - La préparation des données et les premières statistiques (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_01_Data_visualisation_matplotlib_seaborn.html">Chapitre 5 - La data visualisation avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_02_Data_visualisation_cartographie.html">Chapitre 5 - La data visualisation avec Python (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_03_Visualisations_interactives.html">Chapitre 5 - La data visualisation avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_01_Machine_learning_supervise.html">Chapitre 6 - Différentes utilisations dumachine learning avec Python (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Random%20Forest.html">librairies de base</a></li>






<li class="toctree-l1"><a class="reference internal" href="06_02_Machine_learning_non_supervise.html">Chapitre 6 - Différentes utilisations du machine learning avec Python (2ème partie)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_04_Deep_Learning.html">Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_01_Big_data_import.html">Chapitre 7 - Passage au big data (1ère partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_02_Spark.html">Chapitre 7 - Passage au big data (2ème partie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAA_test-checkpoint.html">1. Modelisation des rendements</a></li>

<li class="toctree-l1"><a class="reference internal" href="FORMATION%20PYTHON-checkpoint.html">Introduction</a></li>






<li class="toctree-l1"><a class="reference internal" href="Introduction%20%C3%A0%20Scikit%20Learn-checkpoint.html">Introduction à Scikit Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python%20vs%20R-checkpoint.html">Python vs R : le duel</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F06_03_NLP.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/06_03_NLP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lanalyse-textuelle-avec-python">6.6 L’analyse textuelle avec Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#les-donnees-textuelles-en-python">6.6.1 Les données textuelles en Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#le-pretraitement-des-donnees">6.6.2 Le prétraitement des données</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#re-etape-tokeniser">1re étape : tokeniser</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#e-etape-nettoyage-des-mots-peu-importants">2e étape : Nettoyage des mots peu importants</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#la-mise-en-place-dun-premier-modele-predictif">6.6.3 La mise en place d’un premier modèle prédictif</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapitre-6-differentes-utilisations-du-machine-learning-avec-python-3eme-partie">
<h1>Chapitre 6 - Différentes utilisations du machine learning avec Python (3ème partie)<a class="headerlink" href="#chapitre-6-differentes-utilisations-du-machine-learning-avec-python-3eme-partie" title="Permalink to this heading">#</a></h1>
<section id="lanalyse-textuelle-avec-python">
<h2>6.6 L’analyse textuelle avec Python<a class="headerlink" href="#lanalyse-textuelle-avec-python" title="Permalink to this heading">#</a></h2>
<section id="les-donnees-textuelles-en-python">
<h3>6.6.1 Les données textuelles en Python<a class="headerlink" href="#les-donnees-textuelles-en-python" title="Permalink to this heading">#</a></h3>
<p>Le traitement des donnés textuelles et de la sémantique sont en expansion permanente.</p>
<p>Les données textuelles sont la première source de données non structurées que nous pouvons traiter. Python possède tous les outils pour transformer des
données brutes en données prêtes à être traitées par des algorithmes de machine
learning.</p>
<p>Elles sont fréquemment utilisées notamment pour l’analyse de sentiments, la fouille de textes, le text mining…</p>
<p>Nous allons détailler les différentes étapes pour préparer des données textuelles
afin de les intégrer dans des algorithmes de machine learning. Il va vous falloir de
nouveaux outils.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>showing info https://raw.githubusercontent.com/nltk/nltk_data/gh-pages/index.xml
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception in Tkinter callback
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;C:\Users\trabi\anaconda3\lib\tkinter\__init__.py&quot;, line 1919, in __call__
    if self.subst:
KeyboardInterrupt
</pre></div>
</div>
</div>
</div>
<p>La fenêtre suivante s’ouvre :<br />
<img src="../other/NLTK-downloader.png" alt="NLTK downloader" style="width: 200px;"/></p>
<p>Vous pouvez télécharger tous les packages, ceci ne demande pas beaucoup de mémoire. Il faut néanmoins être connecté à Internet et avoir
une connexion permettant de récupérer quelques centaines de méga-octets de données.
Tous ces packages comprennent des collections, des corpus et des modèles qui
pourront vous servir dans votre approfondissement de NLTK.</p>
<p>Vous trouverez de nombreuses informations ici : <a class="reference external" href="https://www.nltk.org/">https://www.nltk.org/</a></p>
</section>
<section id="le-pretraitement-des-donnees">
<h3>6.6.2 Le prétraitement des données<a class="headerlink" href="#le-pretraitement-des-donnees" title="Permalink to this heading">#</a></h3>
<p>La première étape est de transformer les données brutes en données structurées,
nous allons avoir de nombreuses approches mais il faut dans un premier temps
simplifier les chaînes de caractères en leur appliquant des transformations adaptées
aux besoins.</p>
<p>Dans le cadre de cet exemple, nous allons extraire les thèmes clés d’une page
web. Nous travaillons sur la page Wikipédia en français dédiée au langage Python.</p>
<section id="re-etape-tokeniser">
<h4>1re étape : tokeniser<a class="headerlink" href="#re-etape-tokeniser" title="Permalink to this heading">#</a></h4>
<p>Il est souvent utile d’extraire des mots ou des phrases d’un texte, cette action est
appelée « tokeniser les données ».</p>
<p>Tous les outils de NLTK sont disponibles en anglais mais un certain nombre sont
aussi disponibles en français.</p>
<p>Le code suivant va utiliser le package Beautiful-Soup dont nous avons déjà parlé lors
de l’importation de données dans le chapitre 4. Nous allons récupérer les données
d’une page web directement dans une seule chaîne de caractères :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="c1"># on récupère dans reponse les données de la page</span>
<span class="n">reponse</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span> <span class="s1">&#39;https://fr.wikipedia.org/wiki/Python_(langage)&#39;</span><span class="p">)</span>
<span class="c1"># on extrait le texte en html</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">reponse</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="c1"># on crée un objet de la classe BeautifulSoup pour</span>
<span class="c1"># traiter le code html</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="c1"># on récupère tout le code à partir d’une balise à partri de</span>
<span class="c1"># laquelle on s’intéresse aux données</span>
<span class="n">tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span> <span class="p">:</span> <span class="s1">&#39;mw-parser-output&#39;</span><span class="p">})</span>
<span class="c1"># on extrait le text du code</span>
<span class="n">text</span><span class="o">=</span><span class="n">tag</span><span class="o">.</span><span class="n">text</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;,62752
</pre></div>
</div>
</div>
</div>
<p>Notre objectif est maintenant d’extraire les mots de cette chaîne. Nous pouvons
utiliser :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokens</span><span class="o">=</span><span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;french&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tokens</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;list&#39;&gt; 11933
</pre></div>
</div>
</div>
</div>
<p>On obtient donc une liste de 8 397 tokens qui sont des groupes de caractères
en minuscules. Si on regarde ces termes en utilisant la classe FreqDist qui nous
permet d’étudier les fréquences, on a :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">FreqDist</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="n">freq</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;,&#39;, 607),
 (&#39;de&#39;, 403),
 (&#39;(&#39;, 295),
 (&#39;)&#39;, 295),
 (&#39;.&#39;, 242),
 (&#39;python&#39;, 232),
 (&#39;[&#39;, 188),
 (&#39;]&#39;, 188),
 (&#39;le&#39;, 185),
 (&#39;la&#39;, 169)]
</pre></div>
</div>
</div>
</div>
<p>On voit bien que la plupart des mots sont inintéressants.</p>
</section>
<section id="e-etape-nettoyage-des-mots-peu-importants">
<h4>2e étape : Nettoyage des mots peu importants<a class="headerlink" href="#e-etape-nettoyage-des-mots-peu-importants" title="Permalink to this heading">#</a></h4>
<p>Débarrassons-nous de ce qu’on appelle les stopwords. Il s’agit de mots courants
qui n’ont pas d’influence sur le sens du texte.
NLTK possède une liste de stopwords en français. Nous allons de plus ajouter des
termes spécifiques et enlever la ponctuation résiduelle en utilisant le module string de Python :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span> <span class="nn">string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># création d’une liste de mots, combinée à des mots personnalisés</span>
<span class="c1"># et à la liste de ponctuation</span>
<span class="n">sr</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;french&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;les&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;il&#39;</span><span class="p">,</span><span class="s1">&#39;↑&#39;</span><span class="p">,</span><span class="s1">&#39;«&#39;</span><span class="p">,</span><span class="s1">&#39;»&#39;</span><span class="p">,</span><span class="s1">&#39;·&#39;</span><span class="p">,</span><span class="s1">&#39;``&#39;</span><span class="p">]</span>\
            <span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">)</span>

<span class="c1"># on crée tokens_propres qui consiste en tokens duquel on a retiré les tokens</span>
<span class="c1"># indésirables</span>
<span class="n">tokens_propres</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sr</span><span class="p">]</span>
<span class="c1"># on crée un objet pour calculer les fréquences et on affiche le graphique</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">FreqDist</span><span class="p">(</span><span class="n">tokens_propres</span><span class="p">)</span>
<span class="n">freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Fréquence des mots dans la page&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/88a3fc29c14aee79081a7a532a58833be7df287d5705e465893a56ac9d29def8.png" src="_images/88a3fc29c14aee79081a7a532a58833be7df287d5705e465893a56ac9d29def8.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;Fréquence des mots dans la page&#39;}, xlabel=&#39;Samples&#39;, ylabel=&#39;Counts&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>On obtient un graphique de distribution des mots. On voit que
dans cette page sur le langage Python, on retrouve de nombreux mots clés de cet
ouvrage.</p>
<p>On peut aussi utiliser d’autres outils de NLTK tel que sent_tokenize qui va extraire
des phrases. On peut récupérer des synonymes, par exemple, en utilisant le package
de NLTK nommé WordNet qui possède aussi des synonymes en français.</p>
<p>Jusqu’ici nous avons fait en sorte de transformer des données textuelles non structurées
afin d’éliminer des informations peu importantes et de les structurer. Ce que
nous voulons faire maintenant, c’est traiter ce type de données avec du machine
learning.</p>
</section>
</section>
<section id="la-mise-en-place-dun-premier-modele-predictif">
<h3>6.6.3 La mise en place d’un premier modèle prédictif<a class="headerlink" href="#la-mise-en-place-dun-premier-modele-predictif" title="Permalink to this heading">#</a></h3>
<p>Nous allons donc partir d’un exemple pratique simple, il s’agit de construire un filtre
anti SMS indésirables (spam) pour notre téléphone portable.</p>
<p>L’identification des messages non désirables se base sur des techniques d’apprentissage
combinées à un prétraitement des données.</p>
<p>Nous commençons par récupérer des données (disponibles sur le site associé à
l’ouvrage). Ces données sont décrites plus en détail au début du chapitre 4 :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># recuperation des données</span>
<span class="n">data_sms</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/SMSSpamCollection&quot;</span><span class="p">,</span>
                       <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">])</span>
<span class="c1"># statistique des labels</span>
<span class="n">data_sms</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     4825
spam     747
Name: label, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Scikit-Learn propose des classes pour ces deux approches mais comme on les
combine généralement, on préfère utiliser la classe TfidfVectorizer :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="c1"># on commence par transformer notre variable à prédire en variable binaire</span>
<span class="n">encode_y</span><span class="o">=</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y</span><span class="o">=</span><span class="n">encode_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_sms</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on sépare en apprentissage/validation</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span><span class="n">x_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_sms</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">],</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on transforme en matrice creuse d’occurrence des mots (on transforme x_train</span>
<span class="c1"># et on applique à x_test la transformation)</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">trans_vect</span><span class="o">=</span><span class="n">TfidfVectorizer</span><span class="p">()</span>

<span class="n">x_train_trans</span><span class="o">=</span><span class="n">trans_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">x_test_trans</span><span class="o">=</span><span class="n">trans_vect</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Une fois la transformation effectuée, nous pouvons appliquer un modèle prédictif
sur les données obtenues afin d’apprendre les paramètres du modèle. On essayera
le classifieur bayésien naïf et les support vector machines :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="c1"># on définit deux modèles</span>
<span class="n">modele_bayes</span><span class="o">=</span><span class="n">MultinomialNB</span><span class="p">()</span>
<span class="n">modele_svm</span><span class="o">=</span><span class="n">SVC</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modele_bayes</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_trans</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">modele_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_trans</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on vérifie la qualité du modèle sur les données de vaildation</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy pour naive Bayes:&quot;</span><span class="p">,</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">modele_bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_trans</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy pour naive Bayes: 0.9587443946188341
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy pour SVC :&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">modele_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_trans</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy pour SVC : 0.9811659192825112
</pre></div>
</div>
</div>
</div>
<p>Il ressort que Naive Bayes est bien plus adapté.</p>
<p>On va donc construire un pipeline de traitement :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># on construit un pipeline de traitement</span>
<span class="n">pipe_text</span><span class="o">=</span><span class="n">make_pipeline</span><span class="p">(</span><span class="n">TfidfVectorizer</span><span class="p">(),</span><span class="n">MultinomialNB</span><span class="p">())</span>
<span class="c1"># on l’ajuste à toutes les données</span>
<span class="c1"># sachant qu’on a déjà validé le modèle</span>
<span class="n">pipe_text</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_sms</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pipeline(steps=[(&#39;tfidfvectorizer&#39;, TfidfVectorizer()),
                (&#39;multinomialnb&#39;, MultinomialNB())])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on crée une fonction de filtre qui affiche un message</span>
<span class="k">def</span> <span class="nf">message_filter</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">arr_mess</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">message</span><span class="p">])</span>
    <span class="n">result</span><span class="o">=</span><span class="n">encode_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pipe_text</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">arr_mess</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The message you received is a :&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># on appelle la fonction message_filter avec un nouveau message</span>
<span class="n">message_filter</span><span class="p">(</span><span class="s2">&quot;URGENT, You are a Winner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The message you received is a : spam
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message_filter</span><span class="p">(</span><span class="s2">&quot;Hello, how are u?&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The message you received is a : ham
</pre></div>
</div>
</div>
</div>
<p>On a donc créé une fonction qui permet de prédire si n’importe quel message est
un SMS indésirable.</p>
<p>Il ne reste plus qu’à sauvegarder le modèle dans un fichier pickle pour une intégration dans un produit qui peut être une extension de votre
application de messages.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06_02_Machine_learning_non_supervise.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapitre 6 - Différentes utilisations du machine learning avec Python (2ème partie)</p>
      </div>
    </a>
    <a class="right-next"
       href="06_04_Deep_Learning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapitre 6 - Différentes utilisations dumachine learning avec Python (4ème partie)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lanalyse-textuelle-avec-python">6.6 L’analyse textuelle avec Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#les-donnees-textuelles-en-python">6.6.1 Les données textuelles en Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#le-pretraitement-des-donnees">6.6.2 Le prétraitement des données</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#re-etape-tokeniser">1re étape : tokeniser</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#e-etape-nettoyage-des-mots-peu-importants">2e étape : Nettoyage des mots peu importants</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#la-mise-en-place-dun-premier-modele-predictif">6.6.3 La mise en place d’un premier modèle prédictif</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>